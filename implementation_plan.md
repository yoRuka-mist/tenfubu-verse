# 実装計画 - UI/演出の最終調整

## 完了済みタスク (2025-12-25)

### 1. 味方フォロワー対象選択の実装 ✅
- **課題**: 「翼」などの効果で自分のフォロワーを対象に選ぶことができなかった。
- **解決策**:
    - `GameScreen.tsx` の `handlePlayCard` で、効果の内容に基づいて対象サイド (`allowedTargetPlayerId`) を判定。
    - `targetingState` に `allowedTargetPlayerId` を保持し、UI上で正しいサイドのフォロワーのみ選択可能に。
    - 選択中に味方フォロワーには緑、敵フォロワーには赤のグローを表示。

### 2. エンジン側の汎用的な対象処理 ✅
- **課題**: エンジンが敵ボードのみを対象としていた箇所があった。
- **解決策**:
    - `getBoardCardById` ヘルパーを導入し、IDから両プレイヤーのボードを検索可能に。
    - `DAMAGE`, `DESTROY`, `GRANT_PASSIVE` 等の主要エフェクトでこのヘルパーを使用するように修正。

### 3. 進化アニメーションのサイズと質感の向上 ✅
- **課題**: 進化演出中のカードが大きすぎ、また着地時にサイズが合わなかった。
- **解決策**:
    - 演出中の基本スケールを 0.75 に設定し、元の 3/4 サイズで表示。
    - `cardWidth/cardHeight` を 360/480 に戻し、倍率管理を安定化。
    - **盤面カードの即時非表示**: アニメーション開始と同時に盤面のカードを `opacity: 0` (transitionなし) にすることで、カードが手前に飛び出してきたような一体感を演出。

### 4. カードプレイ時の着地座標とサイズ同期 ✅
- **課題**: カード着地時に画像が小さく、座標も微妙にズレていた。
- **解決策**:
    - `playCardSequence` の最終スケールを 1.0 に設定。
    - `finalY` の計算ロジックを修正し、盤面のスロット位置と完全に一致するように。

### 5. 召喚演出の差別化 ✅
- **課題**: 通常プレイ時にフェードインが発生し、演出がもたついた。
- **解決策**:
    - `Card.css` のデフォルト transition を削除。
    - 特殊召喚時のみアニメーション (`cardSummonAppear`) を適用するようにコード側で制御。

### 6. カードパラメータの調整 ✅
- **課題**: 特定のカードが仕様と異なっていた。
- **解決策**:
    - 「米」のコストを 0 に変更。
    - 「あじゃ」のバフ効果を特定の3体（つぶまる・ゆうなぎ・なゆた）に限定。

---

## 次のステップ

### 演出のさらなるブラッシュアップ
- [ ] リーダーへのダメージ演出を、リーダーの画像の中央から発生するように微調整（座標取得の精度向上）。
- [ ] 勝利・敗北時の演出（VICTORY/DEFEAT）の際に、盤面をよりドラマチックにスローダウンさせる。

### カード仕様の継続的な見直し
- [ ] 他のカード効果もテキストと実際の挙動に乖離がないか再点検。
