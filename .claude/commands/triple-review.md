# トリプルレビュー

実装完了後のコードを Codex、Gemini、Claude(自己) の3つのAIでレビューし、指摘事項を修正するまで繰り返すスキル。

## 実行条件
- 実装が完了していること
- 変更対象のファイルが明確であること

## 実行フロー

### 1. 変更内容の取得
```bash
git diff --name-only  # 変更ファイル一覧
git diff              # 差分内容
```

### 2. レビュープロンプトをファイルに書き出す
`.claude/review_prompts/` ディレクトリに以下のファイルを作成:

- `codex_review.txt` - Codex用レビュープロンプト
- `gemini_review.txt` - Gemini用レビュープロンプト

プロンプトテンプレート:
```
以下の変更をレビューしてください。

## 変更概要
{変更の目的}

## 変更ファイル
{ファイル一覧}

## 差分
{git diff の出力}

## レビュー観点
1. バグ・不具合の可能性
2. パフォーマンス上の問題
3. セキュリティ上の問題
4. 可読性・保守性
5. 設計上の問題

問題点があれば具体的に指摘してください。
問題がなければ「LGTM」と回答してください。
```

### 3. 各AIにレビュー依頼（自動実行）
```bash
# Codexレビュー
codex exec "$(cat .claude/review_prompts/codex_review.txt)"

# Geminiレビュー
gemini "$(cat .claude/review_prompts/gemini_review.txt)"
```

### 4. Claudeセルフレビュー
自分自身で変更内容をレビュー（実装者視点とは別に、レビュアー視点で検証）

### 5. 指摘事項の統合と修正
- 3つのレビュー結果から重要な指摘を抽出
- 重複する指摘は優先度高
- 指摘に基づいて修正を実施
- 修正不要と判断した項目は理由を記録

### 6. 再レビュー（必要な場合）
重大な修正があった場合は 2-5 を繰り返す

### 7. 完了
全ての指摘が解決または却下理由が明確になったら完了

## 実行方法

### コマンド
```
/triple-review
```

### 自然言語
- 「トリプルレビューして」
- 「Codex/Gemini/Claudeでレビュー」
- 「レビュー依頼して」

## 出力形式

```
## トリプルレビュー結果

### Codex
- [指摘1] ...
- [指摘2] ...

### Gemini
- [指摘1] ...
- [指摘2] ...

### Claude
- [指摘1] ...
- [指摘2] ...

### 対応結果
| 指摘 | 対応 | 理由 |
|------|------|------|
| ... | 修正済 / 対応不要 | ... |

### 結論
✅ レビュー完了 - 全ての指摘に対応済み
```

## 注意
- レビュープロンプトは `.claude/review_prompts/` に自動書き出し（許可不要）
- Codex/Geminiコマンド実行も許可済み
- 全て自動で実行され、ユーザー確認は不要
