# 実装済み機能の確認 (Walkthrough)

## 視覚効果とオーディオの強化
- **新規 `fire` アニメーション**: 8x8スプライト形式の火炎エフェクトを実装しました。
- **`shot` アニメーションの調整**: 視覚的なバランスを整えるため、サイズを50%に縮小しました。
- **効果音(SE)の統合**:
    - `thunder.mp3`: 落雷・雷エフェクト用
    - `water.mp3`: 水エフェクト用
    - `ray.mp3`: 光線エフェクト用
    - `yami.mp3`: 墨・闘エフェクト用
    - `ice.mp3`: 氷エフェクト用
    - `fon.mp3`: 進化開始時
    - `gan.mp3`: カード着地時および進化後の着地時
    - `coin.mp3`: コイントス時
    - `kirakira.mp3`: 進化チャージ中（カードが光っている間）
    - `syakin.mp3`: 進化回転開始の瞬間
- **進化アニメーションの大幅改良**:
    - カードサイズを2倍（360x480px）に拡大し、盤面中央よりやや左寄りに配置
    - チャージフェーズ：0度→10度のゆっくり回転、振動エフェクト
    - 白い光のパーティクルが四方からカードに集約（パーティクル数を80個に増加、フェードインしながら移動）
    - カード周囲に「フープのような光の帯」（回転するリング2つ）を追加
    - フリップフェーズ：10度→170度の急速回転（スケールアップ）、170度→180度のゆっくり回転
    - 進化完了時、エネルギーパーティクルがカードから四方に放出
    - **バグ修正**: アニメーションの二重実行問題を解消。
    - **バグ修正（2025-12-23）**: `EvolutionAnimation`コンポーネントの構造的なエラー（JSXが`useEffect`内に誤って配置されていた問題）を修復しました。
- **特殊召喚エフェクトの実装**:
    - 手札からプレイされずに場に出現したカード（トークン生成、効果による召喚など）に専用のアニメーションを追加
    - フェードイン、拡大、光彩エフェクトを組み合わせた「特殊召喚演出」を実装
    - カードごとに`instanceId`を追跡し、手札履歴と比較して特殊召喚を自動検出
    - アニメーション時間: 0.8秒（フェード・スケール変化）+ 0.8秒（光彩オーバーレイ）
- **EP/SEP進化対象マーカー**:
    - EP（黄色）またはSEP（紫色）をドラッグ中に、対象カードにホバーすると回転するマーカーを表示
    - **修正**: SEPドラッグ時のマーカー色（紫）が正しく反映されるように修正。位置をカード中央に補正。
- **UI配置の最適化**:
    - カード使用時の拡大表示位置を、画面中央ではなく右側のボードエリア（サイドバーを除く範囲）の中央に調整しました。
    - 相手リーダーのEP/SEP表示スタイルをプレイヤー側と統一（光彩を追加）。
- **ゲームロジックの修正**:
    - ターゲットが必要なカード（Mono、てんふぶのヤベー2人など）を使用した際、正しくプレイ処理が行われるように修正（フォールバック処理の追加）。
    - 進化アニメーション中にAIが操作を行わないように待機ロジックを強化。
- **カードプレイアニメーションの修正**:
    - 重複していた2箇所のアニメーション実装を1箇所に統一しました。
    - 左側のカード情報カラム（340px）を除いた右側の盤面中央に正しく配置されるように修正しました。
    - アニメーション終了後の残像が表示される問題を解消しました。


## ゲーム操作と安定性
- **手札展開の安定化**:
    - 手札のカードを最初にクリックして展開した際、マウスを離した座標がカード外であっても勝手に閉じないように修正しました。
    - リーダー、ボード上のカード、サイドバーなどのインタラクティブな要素をクリックした際も手札が閉じないようにし、本当の「何もない場所」をクリックした時のみ閉じるように変更しました。
- **ボードの安定性**: 破壊されたユニットを一時的に `null` で保持し、アニメーション完了後にクリーンアップすることで、ターゲット位置（インデックス）がアニメーション中にずれる問題を根本的に解決しました。

## デッキシステム
- **クラス別固定デッキの実装**:
    - 各クラス（SENKA / AJA）に固定の40枚デッキ構成を導入しました。
    - プレイヤーがクラスを選択すると、そのクラスに対応する構築済みデッキが自動的にセットされます。
    - **せんかデッキ（40枚）**: せんか×3, ユキ×3, 無敵の闘士　白ツバキ×3, しゑこ×3, 侍茶×3, ぶっちー×3, ぽてち×3, てんふぶのヤベー2人×3, 大和×2, 曲音×2, Mono×3, ルイ・ユー×2, Y×2, sara×1, 天下布舞・ファイナルキャノン×1, 青ツバキ×3
    - **あじゃデッキ（40枚）**: あじゃ×3, ルイ・ユー×3, Y×3, sara×3, ゆうなぎ×3, つぶまる×3, なゆた×3, ユウリ×2, ウララ×3, かすが×1, バルラ×3, ヴァルキリー×3, 茶トラ×3, 天下布舞・ファイナルキャノン×1, amandava×3

## カード・AIの実装
- **新カード「ユウリ」＆「水氷龍」**:
    - 「ユウリ」（コスト5、3/3、ファンファーレで水氷龍を召喚、進化時に3ダメージ）を実装しました。
    - 「水氷龍」（コスト5、4/4、突進・守護・次の自分のターン開始時に自壊）を実装しました。
    - これに伴い、エンジンに `START_OF_TURN`（ターン開始時）のトリガー処理を追加しました。
- **カード効果の調整**:
    - **ウララ**: `[守護] 進化時：相手のフォロワー1体に2ダメージ。`
    - **大和**: コスト5、5/1、`[疾走]` を持つフォロワー
- **イラストの更新**:
    - 「ゆうなぎ」のイラストパスを `yunagi.png`（通常）および `yunagi_2.png`（進化後）に更新しました。
- **AIターゲットロジックの改善**:
    - CPUが `STEALTH`（潜伏）や `AURA`（オーラ）を持つユニットをカード効果や攻撃の対象にしないように修正しました。

## コードの品質
- **リンター警告の解消**: `GameScreen.tsx` 内の未使用の `import` や定義順序の問題（`playSE` のホイスティング）を修正しました。
- **アニメーションの標準化**: `RAY` や `FIRE` エフェクトを 8x8 スプライトシステムに標準化しました。
