# 修正内容の確認 (Walkthrough) - カードプレイアニメーションの改善

## 修正の概要
カードをプレイした際の、「手札 → 中央（ズームアップ） → 盤面（着地）」というアニメーション一連の流れを改善しました。特に、着地する際の座標を盤面の現在の状況から正確に逆算するようにし、動きを物理的に自然なイーズアウト（減速）に変更しました。

## 主な変更点

### 1. 盤面着地座標の正確な逆算 (`GameScreen.tsx`)
盤面に配置されるカードの現在の枚数と、新しいカードが追加されるインデックスを元に、最終的な `finalX` と `finalY` を計算するロジックを導入しました。
- `spacing = 102` (カード幅90 + 隙間12) を使用し、既存のレンダリングロジックと完全に同期させました。
- プレイヤー側だけでなく、CPU（相手）側のプレイ時や、ターゲット選択が必要なカードのプレイ時にも適用しました。

### 2. アニメーションキーフレームの改善
`playCardSequence` キーフレームを見直し、以下の3フェーズ構成に最適化しました：
- **0-30%**: 手札から中央へ。拡大しながら移動。
- **30-65%**: 中央で大きく表示（ホールド）。カードの内容を確認しやすくしました。
- **65-100%**: 中央から盤面の目標座標へ移動・縮小。

### 3. 滑らかな着地と緩急（メリハリ）の強化
アニメーションのタイミング関数を調整し、さらに各フェーズの時間配分を見直すことで「緩急」をつけました。
- **進化**: 
    - 回転が止まってサイズが縮小する「停滞時間」を完全に削除しました。
    - 代わりに、最後の10度の回転を **1200ms** かけてゆっくり行うことで、カードが最高潮の状態で「溜め」を作るように変更しました。
    - ゆっくりした回転が終わった瞬間、サイズを維持したまま盤面へ **250ms** で一気に収束させ、スナップ感を極限まで高めました。
    - パーティクルサイズを **3倍** に拡大し、周囲の光の帯（リング）を太く、発光も強力に強化しました。

### 4. エフェクト処理のシーケンス制御
連続する効果（ファンファーレでの複数回のダメージや破壊など）が、アニメーションの完了を待ってから順次実行されるようにロジックを刷新しました。
- `isProcessingEffect` フラグを導入し、アニメーション（ダメージ数値の表示や破壊エフェクト）が終了し、盤面の整列が完了した後に次の効果へ進むように制御しています。これにより、破壊されたカードが消えてから次の全体攻撃が行われるといった、視覚的に整合性の取れた表示が可能になりました。

### 5. その他のビジュアル・UI改善
- **進化対象選択**: マーカー（点線円）がカードの正確な中心に表示されるように座標計算を修正しました。
- **ドラッグ矢印**: 進化/超進化時の対象選択矢印に強力なグロー（発光・ぼかし）を適用し、くっきりした線ではなく「光の帯」に見えるように質感を向上させました。
- **スペル描画**: スペル使用時にカード上部にノイズ（名前バーなど）が表示されていた問題を、カードの表示モードを最適化することで修正しました。

## 動作確認項目
- [ ] フォロワーをプレイした際、盤面上の正しいスロットに吸い込まれるように移動するか
- [ ] 中央でカードがしっかり停滞し、内容を確認できるか
- [ ] 中央から盤面への移動がスピーディで、メリハリが感じられるか
- [ ] 進化時、発光した状態で一瞬「溜め」があり、その後素早く盤面に戻るか
